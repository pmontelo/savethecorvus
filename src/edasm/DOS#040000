*********************                  ** DOS 3.3 RELOCATE **  Copyright 1984  ** Patrick Montelo  **                  *********************** Zero page*srcBuf equ $0destBuf equ $2** Screen holes - must match ProROM*ioOffset equ $5F8cfgDrive equ $7F8 ;$678cfgVolsD1 equ $678 ;$6F8cfgVolsD2 equ $6F8 ;$778** DOS 3.3 48K addresses*coldstart equ $9D84 ; $3D3 DOS coldstartkeyvol equ $AA66 ; Set when ,Vxxx parameter specifiediob equ $B7E8 ; $3E3 LDY #$E8, LDA #$B7rwtsPatch equ $BD00 ; $3D9 JMP $B7B5** I/O addresses*ramOff equ $C081** ROM monitor*setnorm equ $FE84init equ $FB2Fsetvid equ $FE93setkbd equ $FE89* org $F00 lda ramOff lda ramOff lda #0 sta srcBuf sta destBuf lda #$10 sta srcBuf+1 lda #$9D sta destBuf+1 ldy #0** Move $1000-32FF to $9D00-BFFF *moveDOS lda (srcBuf),y sta (destBuf),y iny bne moveDOS inc srcBuf+1 inc destBuf+1 lda destBuf+1 cmp #$C0 bne moveDOS** Initialize and connect DOS to ProROM RWTS* jsr setnorm jsr init jsr setvid jsr setkbd lda ioOffset sta iob+1 lsr a lsr a lsr a lsr a tax lda cfgDrive,x sta iob+2 cmp #1 bne getD2vols lda cfgVolsD1,x jmp setVolsgetD2vols lda cfgVolsD2,xsetVols equ ** sta iob+3 ; #$FF stored below sta iob+14 sta keyvol* patch rwtsPatch to call card lda #$4C sta rwtsPatch lda #$7F sta rwtsPatch+1 txa  ; slot ora #$C0 sta rwtsPatch+2 lda #0 sta rwtsPatch+3* ldx #$FF ; Do as in DOSINT txs stx iob+3 jmp coldstart ds $1000-*